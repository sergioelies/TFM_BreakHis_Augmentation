nohup: ignoring input
âœ… Entorno listo. Dispositivo: cuda | Seed: 42

ðŸš€ MODO REAL ACTIVADO
   - Usando dataset completo.
   - ConfiguraciÃ³n completa.
   - âœ… SE GUARDARÃN MODELOS Y RESULTADOS.

========================================
 INICIANDO FASE 1: RANDOM SEARCH 
========================================

ðŸ”¹ Escenario: None
   Trial 1/15 | AUC: 0.9318 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.7}
   Trial 2/15 | AUC: 0.9322 | {'lr': 0.0005, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.3}
   Trial 3/15 | AUC: 0.9325 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.7}
   Trial 4/15 | AUC: 0.9377 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.5}
   Trial 5/15 | AUC: 0.9317 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.3}
   Trial 6/15 | AUC: 0.9303 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.3}
   Trial 7/15 | AUC: 0.9342 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 8/15 | AUC: 0.9271 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.3}
   Trial 9/15 | AUC: 0.9353 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 256, 'dropout': 0.5}
   Trial 10/15 | AUC: 0.9321 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 256, 'dropout': 0.3}
   Trial 11/15 | AUC: 0.9297 | {'lr': 0.0002, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 12/15 | AUC: 0.9252 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.7}
   Trial 13/15 | AUC: 0.9348 | {'lr': 0.0005, 'weight_decay': 0.0001, 'head_hidden': 256, 'dropout': 0.3}
   Trial 14/15 | AUC: 0.9417 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.7}
   Trial 15/15 | AUC: 0.9342 | {'lr': 0.0005, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.3}

ðŸ”¹ Escenario: Basic
   Trial 1/15 | AUC: 0.9256 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 256, 'dropout': 0.3}
   Trial 2/15 | AUC: 0.9405 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 256, 'dropout': 0.5}
   Trial 3/15 | AUC: 0.9404 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 4/15 | AUC: 0.9425 | {'lr': 0.0005, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.5}
   Trial 5/15 | AUC: 0.9411 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.7}
   Trial 6/15 | AUC: 0.9331 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 7/15 | AUC: 0.9445 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.7}
   Trial 8/15 | AUC: 0.9379 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.5}
   Trial 9/15 | AUC: 0.9302 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 10/15 | AUC: 0.9457 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.3}
   Trial 11/15 | AUC: 0.9400 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.7}
   Trial 12/15 | AUC: 0.9407 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.5}
   Trial 13/15 | AUC: 0.9272 | {'lr': 0.0002, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.3}
   Trial 14/15 | AUC: 0.9388 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.7}
   Trial 15/15 | AUC: 0.9364 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 256, 'dropout': 0.3}

ðŸ”¹ Escenario: Advanced
   Trial 1/15 | AUC: 0.9463 | {'lr': 0.0002, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.3}
   Trial 2/15 | AUC: 0.9353 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.3}
   Trial 3/15 | AUC: 0.9422 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.3}
   Trial 4/15 | AUC: 0.9415 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.5}
   Trial 5/15 | AUC: 0.9376 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.3}
   Trial 6/15 | AUC: 0.9491 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.7}
   Trial 7/15 | AUC: 0.9425 | {'lr': 0.0005, 'weight_decay': 0.001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 8/15 | AUC: 0.9440 | {'lr': 0.0005, 'weight_decay': 0.0001, 'head_hidden': 256, 'dropout': 0.3}
   Trial 9/15 | AUC: 0.9480 | {'lr': 0.001, 'weight_decay': 0.001, 'head_hidden': 512, 'dropout': 0.3}
   Trial 10/15 | AUC: 0.9467 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.5}
   Trial 11/15 | AUC: 0.9444 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 12/15 | AUC: 0.9498 | {'lr': 0.0002, 'weight_decay': 0.0001, 'head_hidden': 512, 'dropout': 0.5}
   Trial 13/15 | AUC: 0.9389 | {'lr': 0.0005, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.5}
   Trial 14/15 | AUC: 0.9438 | {'lr': 0.0005, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.3}
   Trial 15/15 | AUC: 0.9441 | {'lr': 0.001, 'weight_decay': 0.0001, 'head_hidden': 128, 'dropout': 0.7}
/workspace/train_breakhis.py:317: FutureWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  df_top3 = df_rs.groupby("scenario").apply(lambda x: x.nlargest(3, 'val_auc')).reset_index(drop=True)

ðŸ† TOP 3 CANDIDATOS SELECCIONADOS:
   scenario   val_auc      lr  head_hidden
0  Advanced  0.949815  0.0002          512
1  Advanced  0.949084  0.0010          512
2  Advanced  0.947968  0.0010          512
3     Basic  0.945697  0.0005          128
4     Basic  0.944466  0.0005          512
5     Basic  0.942503  0.0005          512
6      None  0.941733  0.0010          512
7      None  0.937692  0.0010          512
8      None  0.935345  0.0010          256

========================================
 INICIANDO FASE 2: CV INTERNA SOBRE TOP 3 
========================================

ðŸ”¶ Evaluando: Advanced_Cand0 (lr=0.0002, hidden=512)
   > Fold 1/3... Best: 0.8334
   > Fold 2/3... Best: 0.9230
   > Fold 3/3... Best: 0.9622

ðŸ”¶ Evaluando: Advanced_Cand1 (lr=0.001, hidden=512)
   > Fold 1/3... Best: 0.8408
   > Fold 2/3... Best: 0.9298
   > Fold 3/3... Best: 0.9634

ðŸ”¶ Evaluando: Advanced_Cand2 (lr=0.001, hidden=512)
   > Fold 1/3... Best: 0.8354
   > Fold 2/3... Best: 0.9210
   > Fold 3/3... Best: 0.9633

ðŸ”¶ Evaluando: Basic_Cand3 (lr=0.0005, hidden=128)
   > Fold 1/3... Best: 0.8428
   > Fold 2/3... Best: 0.9365
   > Fold 3/3... Best: 0.9544

ðŸ”¶ Evaluando: Basic_Cand4 (lr=0.0005, hidden=512)
   > Fold 1/3... Best: 0.8356
   > Fold 2/3... Best: 0.9353
   > Fold 3/3... Best: 0.9524

ðŸ”¶ Evaluando: Basic_Cand5 (lr=0.0005, hidden=512)
   > Fold 1/3... Best: 0.8302
   > Fold 2/3... Best: 0.9284
   > Fold 3/3... Best: 0.9537

ðŸ”¶ Evaluando: None_Cand6 (lr=0.001, hidden=512)
   > Fold 1/3... Best: 0.8513
   > Fold 2/3... Best: 0.9269
   > Fold 3/3... Best: 0.9574

ðŸ”¶ Evaluando: None_Cand7 (lr=0.001, hidden=512)
   > Fold 1/3... Best: 0.8539
   > Fold 2/3... Best: 0.9225
   > Fold 3/3... Best: 0.9566

ðŸ”¶ Evaluando: None_Cand8 (lr=0.001, hidden=256)
   > Fold 1/3... Best: 0.8516
   > Fold 2/3... Best: 0.9188
   > Fold 3/3... Best: 0.9536

ðŸŽ‰ GANADORES FINALES POR ESCENARIO:
   Scenario  Mean_AUC
0  Advanced  0.911329
1     Basic  0.911217
2      None  0.911870

========================================
 INICIANDO FASE 3: TEST FINAL 
========================================

ðŸš€ Entrenando Final: Advanced...
   -> AUC Test: 0.9739 | Youden Thresh: 0.1609
   -> Bootstraping...

ðŸš€ Entrenando Final: Basic...
   -> AUC Test: 0.9541 | Youden Thresh: 0.1476
   -> Bootstraping...

ðŸš€ Entrenando Final: None...
   -> AUC Test: 0.9653 | Youden Thresh: 0.1978
   -> Bootstraping...

ðŸ’¾ GUARDANDO RESULTADOS EN DISCO...
âœ… Todo guardado: .csv, .npy y .pth listos para descargar.
